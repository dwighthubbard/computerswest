{% macro render_nav(items, level=0) %}
<ul class="cw-nav-level cw-nav-level-{{ level }}">
  {% for item in items %}
  {% set children = item.children if item.children is defined and item.children else [] %}
  {% set is_active = item.active or (children | selectattr('active') | list | length > 0) %}
  <li class="cw-nav-item level-{{ level }}{% if is_active %} active{% endif %}{% if children %} has-children{% endif %}">
    {% if item.url %}
    <a href="{{ item.url | url }}" class="cw-nav-link">{{ item.title }}</a>
    {% else %}
    <span class="cw-nav-link">{{ item.title }}</span>
    {% endif %}
    {% if children %}
      {{ render_nav(children, level + 1) }}
    {% endif %}
  </li>
  {% endfor %}
</ul>
{% endmacro %}

{% macro render_toc(items) %}
<ul class="cw-toc-list">
  {% for toc_item in items %}
  <li class="toc-level-{{ toc_item.level }}">
    <a href="{{ toc_item.url }}">{{ toc_item.title }}</a>
    {% if toc_item.children %}
      {{ render_toc(toc_item.children) }}
    {% endif %}
  </li>
  {% endfor %}
</ul>
{% endmacro %}

<!DOCTYPE html>
<html lang="{{ config.site_language or 'en' }}">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% if page.meta and page.meta.title %}{{ page.meta.title }} | {% elif page.title and not page.is_homepage %}{{ page.title }} | {% endif %}{{ config.site_name }}</title>
    {% if page.meta and page.meta.description %}
    <meta name="description" content="{{ page.meta.description }}" />
    {% endif %}
    {% if page.canonical_url %}
    <link rel="canonical" href="{{ page.canonical_url }}" />
    {% endif %}
    <link rel="icon" type="image/png" href="{{ 'https://computerswest.org/wp-content/uploads/2024/03/cw-logo-clear8-e1711862350250.png' | url }}" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@300;400;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="{{ 'assets/stylesheets/computerswest.css' | url }}" />
    {% for path in config.extra_css %}
    <link rel="stylesheet" href="{{ path | url }}" />
    {% endfor %}
    {% block extrahead %}{% endblock %}
  </head>
  <body class="{% if page.is_homepage %}is-homepage{% endif %}">
    <a class="cw-skip-link" href="#main-content">Skip to content</a>
    <header class="cw-site-header">
      {% set homepage_url = nav.homepage.url if nav.homepage else '.' %}
      <div class="cw-hero">
        <div class="cw-hero-overlay"></div>
        <div class="cw-hero-inner">
          <div class="cw-brand">
            <a class="cw-logo" href="{{ homepage_url | url }}">
              <img src="{{ 'https://computerswest.org/wp-content/uploads/2024/03/cw-logo-clear8-e1711862350250.png' | url }}" alt="{{ config.site_name }} logo" />
            </a>
            <div class="cw-brand-text">
              <span class="cw-tagline">{{ config.extra.tagline or 'Sun City West Computer Club' }}</span>
              <span class="cw-site-name">{{ config.site_name }}</span>
            </div>
          </div>
          <div class="cw-hero-meta">
            {% if config.extra.address %}
            <p class="cw-hero-address">{{ config.extra.address }}</p>
            {% endif %}
            {% if config.extra.phone %}
            <p class="cw-hero-phone">{{ config.extra.phone }}</p>
            {% endif %}
            {% if config.extra.hours %}
            <p class="cw-hero-hours">{{ config.extra.hours }}</p>
            {% endif %}
          </div>
        </div>
      </div>
      <div class="cw-main-bar">
        <button class="cw-nav-toggle" type="button" aria-expanded="false" aria-controls="site-nav">
          <span class="cw-nav-toggle-bar"></span>
          <span class="cw-nav-toggle-bar"></span>
          <span class="cw-nav-toggle-bar"></span>
          <span class="cw-nav-toggle-label">Menu</span>
        </button>
        <nav id="site-nav" class="cw-primary-nav" aria-label="Primary">
          {{ render_nav(nav.items if nav.items is defined else nav) }}
        </nav>
        <form class="cw-search" action="{{ 'search.html' | url }}" method="get" role="search">
          <label class="cw-search-label" for="search-input">Search</label>
          <input id="search-input" type="search" name="q" placeholder="Search this site" />
          <button type="submit" class="cw-search-button">Go</button>
        </form>
      </div>
    </header>
    <main id="main-content" class="cw-main">
      <div class="cw-main-layout">
        <div class="cw-content-area">
          <article class="cw-article">
            {% if not page.is_homepage %}
            <header class="cw-article-header">
              <h1>{{ page.title }}</h1>
            </header>
            {% endif %}
            <div class="cw-article-body markdown-body">
              {{ page.content }}
            </div>
            <footer class="cw-article-footer">
              <div class="cw-page-nav">
                {% if page.previous_page %}
                <a class="cw-prev" href="{{ page.previous_page.url | url }}">&larr; {{ page.previous_page.title }}</a>
                {% endif %}
                {% if page.next_page %}
                <a class="cw-next" href="{{ page.next_page.url | url }}">{{ page.next_page.title }} &rarr;</a>
                {% endif %}
              </div>
            </footer>
          </article>
        </div>
        <aside class="cw-sidebar">
          <section class="cw-card cw-cta">
            <h2>Visit Us</h2>
            <p>{{ config.extra.address or 'Palm Ridge Center · West Deer Valley Drive · Sun City West, AZ 85375' }}</p>
            {% if config.extra.phone %}
            <p class="cw-card-highlight">Call {{ config.extra.phone }}</p>
            {% endif %}
            <a class="cw-button" href="{{ 'membership/index/' | url }}">Join Computers West</a>
          </section>
          {% if page.toc and page.toc.items %}
          <section class="cw-card cw-toc">
            <h2>On this page</h2>
            {{ render_toc(page.toc.items) }}
          </section>
          {% endif %}
          {% if config.extra.sidebar_highlights %}
            {% for highlight in config.extra.sidebar_highlights %}
            <section class="cw-card cw-highlight">
              <h2>{{ highlight.title }}</h2>
              <p>{{ highlight.description }}</p>
              {% if highlight.url %}
              <a class="cw-button secondary" href="{{ highlight.url | url }}">{{ highlight.cta or 'Learn more' }}</a>
              {% endif %}
            </section>
            {% endfor %}
          {% endif %}
        </aside>
      </div>
    </main>
    <footer class="cw-footer">
      <div class="cw-footer-inner">
        <div class="cw-footer-brand">
          <a class="cw-footer-logo" href="{{ homepage_url | url }}">
            <img src="{{ 'https://computerswest.org/wp-content/uploads/2024/03/cw-logo-clear8-e1711862350250.png' | url }}" alt="{{ config.site_name }} logo" />
          </a>
          <div class="cw-footer-text">
            <span class="cw-site-name">{{ config.site_name }}</span>
            <span class="cw-tagline">{{ config.extra.tagline or 'Sun City West Computer Club' }}</span>
          </div>
        </div>
        <div class="cw-footer-info">
          {% if config.extra.address %}<p>{{ config.extra.address }}</p>{% endif %}
          {% if config.extra.phone %}<p>{{ config.extra.phone }}</p>{% endif %}
          <p class="cw-footer-hours">{{ config.extra.hours or 'Mon–Fri 8:00 am–4:00 pm (Seasonal hours may vary)' }}</p>
        </div>
        <div class="cw-footer-meta">
          <p>&copy; {{ config.site_name }} {{ build_date_utc.strftime('%Y') }}</p>
          <p class="cw-footer-made">Built with MkDocs.</p>
        </div>
      </div>
    </footer>
    <script src="{{ 'assets/javascripts/computerswest.js' | url }}"></script>
    {% for script in config.extra_javascript %}
    <script src="{{ script | url }}"></script>
    {% endfor %}
    {% block scripts %}{% endblock %}
  </body>
</html>
